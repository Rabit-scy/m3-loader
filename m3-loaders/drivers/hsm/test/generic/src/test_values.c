/*
    SPC5-CRYPTO - Copyright (C) 2014 STMicroelectronics

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
*/

/**
 * @file    test_values.c
 * @brief   CSE tests reference values
 * @details
 *
 *
 * @addtogroup CSE_driver_test
 * @{
 */

#ifndef TEST_VALUES_INCLUDED_H
#define TEST_VALUES_INCLUDED_H
#include "cse_typedefs.h"
#include "test_values.h"

/* for status display */
#include "serialprintf.h"
#include "cse_client.h"

typedef struct
{
	uint8_t* key;
	uint32_t fid;
}key_desc_stt;


uint32_t empty_key[4] = { 0x00000000, 0x00000000, 0x00000000, 0x00000000 };


uint32_t iv[4] = { 0, 0, 0, 0 };
uint32_t mac[4] = { 0, 0, 0, 0 };

uint32_t challenge[4] = { 0x12345678, 0x00000000, 0x12345678, 0x00000000 };
//uint32_t master_key[4]= { 0xD275F12C, 0xA863A7B5, 0xF933DF92, 0x6498FB4D };
uint32_t master_key[4]= { 0x2CF175D2, 0xB5A763A8, 0x92DF33F9, 0x4DFB9864 };

vuint32_t ID[4] =       { 0x00000000, 0x00000000, 0x00000000, 0x00000000 };



/* If the address is the end of the system RAM (0x4001FFC0), then we can have a 64KB buffer*/
/* !!!! If we keep the Host/CSE emulated registers shared area in the middle of system RAM, we can not test with 64KB payload  */
uint8_t src_large[32768];

uint32_t exp_mac[4] = { 0x763CBCDE, 0x81DF9131, 0xBF897712, 0xC088EDAD };


uint8_t master_key_byte[16] = { 0xD2,0x75,0xF1,0x2C,0xA8,0x63,0xA7,0xB5,0xF9,0x33,0xDF,0x92,0x64,0x98,0xFB,0x4D};
uint8_t bootmac_key[16] ={ 0x12,0x34,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x56,0x78};

uint8_t Key_1[16]  = { 0x2F,0xF8,0xB0,0x3C,0x5C,0x54,0x05,0x46,0x5A,0x9C,0x94,0xBD,0x2D,0x86,0x32,0x79};
uint8_t Key_2[16]  = { 0x85,0x85,0x2F,0xF8,0xE7,0x86,0x0C,0x89,0xB3,0xAB,0x9D,0x63,0xB8,0xD6,0x28,0x8F};
uint8_t Key_3[16]  = { 0xA3,0x6F,0xF1,0x44,0xFB,0x6D,0x5E,0x2C,0xDA,0x0D,0x28,0x94,0x1E,0x96,0x3E,0x35};
uint8_t Key_4[16]  = { 0x86,0x07,0x8C,0x1A,0xBC,0xDC,0xC6,0xB6,0xC5,0x2C,0x85,0x1D,0xE5,0x65,0x2B,0xF5};
uint8_t Key_5[16]  = { 0x04,0x3A,0x1A,0x50,0xDB,0x39,0x54,0xD2,0x22,0xFE,0xB3,0x7F,0x1F,0x67,0x8F,0xCA};
uint8_t Key_6[16]  = { 0x4B,0x95,0x77,0x50,0x02,0x1C,0x01,0x9C,0x6F,0x75,0xC3,0xE0,0x5C,0x8D,0xCD,0x59};
uint8_t Key_7[16]  = { 0x2b,0x7e,0x15,0x16,0x28,0xae,0xd2,0xa6,0xab,0xf7,0x15,0x88,0x09,0xcf,0x4f,0x3c};
uint8_t Key_8[16]  = { 0x10,0xAF,0x4B,0x5B,0x02,0x41,0x95,0xB9,0x17,0x30,0xD7,0xF5,0x94,0xC8,0x7E,0x19};
uint8_t Key_9[16]  = { 0x93,0x34,0x6F,0x4C,0x6A,0x8A,0xBC,0xCD,0x37,0xD5,0x22,0x49,0x29,0x1F,0x41,0x38};
uint8_t Key_10[16] = { 0x68,0xB6,0x74,0xCB,0x81,0x98,0xA2,0x50,0x3A,0x28,0x51,0x00,0xF4,0xDD,0xC4,0x0A};


/* To avoid confusion and detect any normal/extended key set mix,
 * set key11..20 in reverse order compared to 1..10
 */
uint8_t Key_11[16] = { 0x68,0xB6,0x74,0xCB,0x81,0x98,0xA2,0x50,0x3A,0x28,0x51,0x00,0xF4,0xDD,0xC4,0x0A};
uint8_t Key_12[16] = { 0x93,0x34,0x6F,0x4C,0x6A,0x8A,0xBC,0xCD,0x37,0xD5,0x22,0x49,0x29,0x1F,0x41,0x38};
uint8_t Key_13[16] = { 0x10,0xAF,0x4B,0x5B,0x02,0x41,0x95,0xB9,0x17,0x30,0xD7,0xF5,0x94,0xC8,0x7E,0x19};
uint8_t Key_14[16] = { 0x2b,0x7e,0x15,0x16,0x28,0xae,0xd2,0xa6,0xab,0xf7,0x15,0x88,0x09,0xcf,0x4f,0x3c};
uint8_t Key_15[16] = { 0x4B,0x95,0x77,0x50,0x02,0x1C,0x01,0x9C,0x6F,0x75,0xC3,0xE0,0x5C,0x8D,0xCD,0x59};
uint8_t Key_16[16] = { 0x04,0x3A,0x1A,0x50,0xDB,0x39,0x54,0xD2,0x22,0xFE,0xB3,0x7F,0x1F,0x67,0x8F,0xCA};
uint8_t Key_17[16] = { 0x86,0x07,0x8C,0x1A,0xBC,0xDC,0xC6,0xB6,0xC5,0x2C,0x85,0x1D,0xE5,0x65,0x2B,0xF5};
uint8_t Key_18[16] = { 0xA3,0x6F,0xF1,0x44,0xFB,0x6D,0x5E,0x2C,0xDA,0x0D,0x28,0x94,0x1E,0x96,0x3E,0x35};
uint8_t Key_19[16] = { 0x85,0x85,0x2F,0xF8,0xE7,0x86,0x0C,0x89,0xB3,0xAB,0x9D,0x63,0xB8,0xD6,0x28,0x8F};
uint8_t Key_20[16] = { 0x2F,0xF8,0xB0,0x3C,0x5C,0x54,0x05,0x46,0x5A,0x9C,0x94,0xBD,0x2D,0x86,0x32,0x79};


/* Flags is on 8 bits, with the 2 lsb bits set to 0
 * WP|BP|DP|KU|WC|VO|0|0
 */
key_desc_stt key_array[20] =
{
	{ Key_1, 0x00 },    /* */
#if 0
	{ Key_2, 0x88 },	/* WP | WC */
#else
	{ Key_2, 0x14 },	/* KU | VO  --> MAC verification only */
#endif
	{ Key_3, 0x40 },	/* BP */
	{ Key_4, 0x20 },	/* DP */
	{ Key_5, 0x10 },	/* KU */
	{ Key_6, 0x00 },	/* */
	{ Key_7, 0x10 },	/* KU */
	{ Key_8, 0x30 },	/* DP | KU */
	{ Key_9, 0x00 },	/* WC */
	{ Key_10, 0x50 },	/* BP | KU */


	{ Key_11, 0x00 },   /* */
#if 0
	{ Key_12, 0x88 },	/* WP | WC */
#else
	{ Key_12, 0x14 },	/* KU | VO  --> MAC verification only */
#endif
	{ Key_13, 0x40 },	/* BP */
	{ Key_14, 0x20 },	/* DP */
	{ Key_15, 0x10 },	/* BP */
	{ Key_16, 0x00 },	/* WC */
	{ Key_17, 0x10 },	/* BP */
	{ Key_18, 0x30 },	/* DP | KU */
	{ Key_19, 0x00 },	/* */
	{ Key_20, 0x50 }    /* BP | KU */
};

/*
 *  Secure Boot test values
 */
#define BL_WORD_SZ  ((uint32_t)32)
uint32_t ref_boot_loader[BL_WORD_SZ] = {
		0xB61C75C0,	0x9FEC0524,	0x66414070,	0x6C4E1BD1,
		0xAEB7E985,	0xE9AB7CD3,	0xCD779188,	0xB2382049,
		0x927CA102,	0x761F195D,	0x404B8C41,	0x86354D38,
		0xAF5C1FC5,	0x78983111,	0xA21AC9E3,	0xB2DA46B6,
		0x9FD49878,	0x5977A146,	0x3DCC25C2,	0x19337A67,
		0x83B3FBBC,	0x2604FE82,	0x7AEEF3AA,	0x2D09E95E,
		0xD120C731,	0x5F1102ED,	0x3DE352F9,	0x0E50AEDB,
		0x662C5519,	0x0F7368E0,	0xDCA54BBA,	0x0EF728DF };

uint32_t ref_boot_loader_size = 4*BL_WORD_SZ;
uint32_t* corrupted_boot_loader = ref_boot_loader;
uint32_t  corrupted_boot_loader_size =  4*BL_WORD_SZ - 1;

uint32_t ref_boot_mac[4] = { 0x2FB49908, 0x21CD0FB1, 0xA4F51B38, 0xE6F45D85 };

#endif
/**
 * @}
 */
